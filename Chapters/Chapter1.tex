% Chapter 1

\chapter{Introducción general} % Main chapter title

\label{Chapter1} % For referencing the chapter elsewhere, use \ref{Chapter1} 
\label{IntroGeneral}

%----------------------------------------------------------------------------------------

% Define some commands to keep the formatting separated from the content 
\newcommand{\keyword}[1]{\textbf{#1}}
\newcommand{\tabhead}[1]{\textbf{#1}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\file}[1]{\texttt{\bfseries#1}}
\newcommand{\option}[1]{\texttt{\itshape#1}}
\newcommand{\grados}{$^{\circ}$}

En este capítulo se presenta el marco de referencia y la justificación del trabajo Modernización de contadores de tránsito con comunicación bidireccional. Se expone el contexto que motivó su desarrollo, los problemas detectados en la infraestructura actual, una revisión del estado del arte, la propuesta de valor y el alcance del prototipo planteado.


%----------------------------------------------------------------------------------------

%\section{Introducción}

%----------------------------------------------------------------------------------------

\section{Motivación}

Este trabajo propone la modernización de los contadores de tránsito instalados en rutas nacionales mediante la renovación de su arquitectura de comunicaciones. Actualmente los equipos registran el paso de vehículos y transmiten eventos al servidor central a través de enlaces GPRS tercerizados. No obstante, no admiten la recepción de comandos ni la obtención de diagnósticos remotos. Esta limitación reduce la capacidad operativa, incrementa los costos de mantenimiento y demora la resolución de fallas, debido que todo ajuste o reparación requiere una intervención presencial.

La propuesta se origina a partir del desarrollo de un contador de tránsito destinado a registrar y transmitir información en campo. Sin embargo, la conexión remota de este dispositivo presenta limitaciones en cuanto a su capacidad de transmisión de datos y carece de mecanismos de control remoto, lo que dificulta tanto la supervisión del funcionamiento como la actualización de sus parámetros. Frente a estas restricciones, surge la necesidad de modernizar el sistema mediante la incorporación de una comunicación bidireccional confiable. Para ese propósito se plantearon tres metas principales: en primer lugar, garantizar la entrega de eventos, incluso en condiciones de conectividad intermitente. En segundo lugar, implementar mecanismos de encolamiento y reintento en el dispositivo que eviten duplicaciones y pérdidas de información y, por último, habilitar la ejecución remota de comandos y la actualización de parámetros desde un servidor central, con una confirmación explícita del estado del equipo.

Los objetivos específicos buscan fortalecer la autonomía operativa de la institución y a reducir costos recurrentes asociados a la dependencia de proveedores externos de conectividad. En particular, el trabajo aspira a: 
\begin{itemize}
\item Disminuir la dependencia de enlaces tercerizados mediante una arquitectura configurable.

\item Permitir la modificación remota de parámetros operativos y la carga de ajustes sin requerir desplazamientos. 

\item Incorporar telemetría de estado (nivel de batería, temperatura y códigos de error) para facilitar el mantenimiento preventivo.

\item Validar la viabilidad técnica, la robustez operativa.
\end{itemize}

El alcance técnico incluye la adaptación de un contador existente para comunicarse bidireccionalmente por GPRS, que emplee MQTT como protocolo de mensajería ligera y confiable. Asimismo, comprende el desarrollo de un backend que reciba, procese y persista los eventos en una base de datos relacional. Además, una interfaz web básica que permita la visualización en tiempo real y el envío de comandos hacia los dispositivos. Se priorizan las funciones que validen la cadena completa: adquisición de eventos desde el sistema de detección, encolamiento local con política FIFO, reenvío seguro cuando haya conectividad, recepción y ejecución de comandos y verificación del estado del dispositivo tras cada acción.

Desde la perspectiva de operación y mantenimiento, la modernización permite reducir los desplazamientos de personal técnico y acortar los tiempos de resolución de incidentes con la consiguiente disminución de costos logísticos. La incorporación de telemetría facilita la planificación de intervenciones preventivas en lugar de responder exclusivamente a fallas, lo que optimiza la disponibilidad del servicio y la calidad de los datos recolectados. Además, la adopción de protocolos estandarizados y componentes de código abierto promueve la escalabilidad y la replicabilidad de la solución en distintos tramos de la red vial.

Por último, la propuesta separa de forma explícita el transporte de mensajes (broker MQTT) de los servicios de aplicación (API REST, almacenamiento y frontend). Esta separación facilita la interoperabilidad con plataformas institucionales existentes y habilita opciones de despliegue flexibles: uso de brokers externos, instalación de brokers locales o modelos híbridos según políticas institucionales y condiciones de conectividad. En síntesis, el trabajo busca ofrecer una solución técnica y económica que permita gestionar de manera proactiva y eficiente la infraestructura de conteo de tránsito que proporcione una base verificable para su posterior escalado e integración institucional.

Referencias bibliográficas que respaldaron las decisiones técnicas:
\begin{itemize}
  \item \href{https://www.fhwa.dot.gov/policyinformation/tmguide/2022_TMG_Final_Report.pdf}{FHWA — Traffic Monitoring Guide (2022)}.
  \item \href{https://www.fhwa.dot.gov/publications/research/operations/its/06108/06108.pdf}{FHWA — Traffic Detector Handbook, 3ª ed. (2006)}.
  \item \href{https://www.mdpi.com/1424-8220/21/2/338}{Asiain et al., ``LoRa-Based Traffic Flow Detection for Smart-Road'' (2021)}.
  \item \href{https://www.mdpi.com/2076-3417/12/3/1497}{Peruzzi et al., ``Combining LoRaWAN and NB-IoT for Edge-to-Cloud Low-Power Connectivity'' (2022)}.
  \item \href{https://miovision.com/trafficlink/}{Miovision — TrafficLink / Managed Connectivity (soluciones comerciales)}.
  \item \href{https://sensysnetworks.com/}{Sensys Networks — documentación técnica y productos}.
  \item \href{https://www.metrocount.com/}{MetroCount — contadores y guías técnicas}.
  \item \href{https://www.mdpi.com/1424-8220/23/9/4469}{Micko et al., ``Review of IoT Sensor Systems Used for Monitoring the Road Infrastructure'' (2023)}.
\end{itemize}



%----------------------------------------------------------------------------------------

\section{Limitaciones sistema actual}

El análisis del sistema vigente permitió identificar las siguientes limitaciones que motivan el rediseño:

\begin{itemize}
\item  Comunicación unidireccional. Los contadores envían datos al servidor pero no existe un canal para enviar configuraciones, consultas y comandos desde el servidor hacia los equipos. Esta limitación impide realizar diagnósticos remotos y ejecutar acciones correctivas sin presencia física.

\item  Dependencia de proveedores GPRS tercerizados. La dependencia de servicios contratados genera costos recurrentes y limita el control sobre la calidad y disponibilidad de la conectividad.

\item  Imposibilidad de actualización remota. Cualquier modificación de parámetros o ajustes de operación requiere intervención en el sitio. Esto incrementa tiempos de mantenimiento, costos logísticos y complica la aplicación rápida de mejoras.

\item  Falta de telemetría y diagnóstico preventivo. No se dispone de métricas sistemáticas sobre el estado operativo de los equipos (batería, temperatura, errores de hardware o comunicación).

\item Riesgo de pérdida de datos ante conectividad intermitente. La ausencia de mecanismos de encolamiento persistente y de políticas claras de reenvío eleva la probabilidad de pérdida o duplicación de eventos cuando la red es inestable.

\end{itemize}

Estas deficiencias afectan la calidad del servicio de monitoreo, reducen la eficiencia operativa y constituyen los requisitos funcionales que orientan el diseño del prototipo.


\section{Estado del arte y propuesta de valor}

En el mercado existen soluciones comerciales que ofrecen gestión remota y comunicación bidireccional para dispositivos de campo. Dichas soluciones suelen incluir plataformas propietarias con soporte, servicio administrado y herramientas de análisis. No obstante, su adopción conlleva costos elevados y, en muchos casos, dependencias tecnológicas que dificultan la adaptación a especificidades locales.

La propuesta de este trabajo adopta un enfoque alternativo: emplear tecnologías de código abierto y protocolos estandarizados, especialmente MQTT, para construir una arquitectura flexible, escalable y de bajo costo. La separación entre el transporte de mensajes (broker MQTT) y los servicios de aplicación (API REST, base de datos y frontend) facilita la interoperabilidad y permite operar con brokers locales o externos según requieran las políticas institucionales.

Adicionalmente, la solución incorpora mecanismos diseñados para condiciones operativas típicas de rutas nacionales: operación con conectividad intermitente, envío diferido con políticas FIFO, control de reintentos para evitar duplicados y autenticación de credenciales en el broker MQTT. Este conjunto de medidas asegura integridad y trazabilidad de los eventos sin depender exclusivamente de servicios propietarios.

El valor diferencial reside en ofrecer una alternativa económicamente viable que preserve funcionalidad y escalabilidad, y que a su vez permita a la institución mantener control operativo sobre la infraestructura. La propuesta facilita la migración progresiva desde soluciones tercerizadas hacia una plataforma propia o semiautónoma, que reduce costos recurrentes y mejora la capacidad de respuesta ante incidentes.


\section{Alcance}
El trabajo desarrolla un prototipo funcional destinado a validar las hipótesis técnicas y operativas. El alcance comprende los siguientes objetivos y límites:

\begin{itemize}

\item Rediseño de comunicaciones: implementación de un modelo bidireccional y seguro entre los dispositivos de conteo y el servidor central, basado en MQTT sobre GPRS y con autenticación por credenciales.

\item Gestión de mensajes en el dispositivo: encolamiento en memoria RAM con política FIFO, control de reintentos ante fallos de conexión y lógica de descarte cuando la cola alcance su límite definido.

\item Backend y persistencia: desarrollo de una API REST que se suscriba al broker MQTT, procese los eventos y almacene los registros en una base de datos relacional para consulta histórica.

\item Interfaz web básica: panel de visualización en tiempo real de eventos de tránsito y módulo para envío de comandos y verificación de estado de los dispositivos.

\item Funciones de telemetría: reporte de nivel de batería, temperatura y códigos de error para facilitar el diagnóstico remoto.

\end{itemize}

La figura \ref{fig:diag_bloques} muestra el diagrama en bloques del sistema. 
El dispositivo de conteo envía datos por GPRS a un broker MQTT; el servidor central 
los procesa y almacena en una base de datos, mientras que una API REST permite su 
consulta y la ejecución de comandos desde una interfaz web.

\vspace{1cm}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=\linewidth]{./Figures/diagBloques.png}
  \caption{Diagrama en bloques del sistema.}
  \label{fig:diag_bloques}
\end{figure}

\vspace{1cm}










